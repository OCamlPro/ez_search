<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>EzSearch (ez_search.Ez_search.V1.EzSearch)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">ez_search</a> &#x00BB; <a href="../../index.html">Ez_search</a> &#x00BB; <a href="../index.html">V1</a> &#x00BB; EzSearch</nav><header class="odoc-preamble"><h1>Module <code><span>V1.EzSearch</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-TYPES" class="anchored"><a href="#module-TYPES" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="TYPES/index.html">TYPES</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-index_directory" class="anchored"><a href="#val-index_directory" class="anchor"></a><code><span><span class="keyword">val</span> index_directory : <span>db_dir:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>index_directory ~db_dir DIRECTORY</code> index all files in <code>DIRECTORY</code>, and store the index in <code>db_dir</code>. Every top-directory in DIRECTORY is considered as a <code>file_entry</code> name, and <code>file_name</code> are within top-directories.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-load_db" class="anchored"><a href="#val-load_db" class="anchor"></a><code><span><span class="keyword">val</span> load_db : <span>db_dir:string <span class="arrow">&#45;&gt;</span></span> <span>?use_mapfile:bool <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="TYPES/index.html#type-db">TYPES.db</a></span></code></div><div class="spec-doc"><p><code>load_db ~db_dir</code> loads the database in memory. Note: in the next version, we should aim at using mmap.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-count_lines_total" class="anchored"><a href="#val-count_lines_total" class="anchor"></a><code><span><span class="keyword">val</span> count_lines_total : <span>db:<a href="TYPES/index.html#type-db">TYPES.db</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>count_lines_total ~db</code> counts the number of '\n' in the database.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-search" class="anchored"><a href="#val-search" class="anchor"></a><code><span><span class="keyword">val</span> search : <span>db:<a href="TYPES/index.html#type-db">TYPES.db</a> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>(<span><a href="TYPES/index.html#type-occurrence">TYPES.occurrence</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span>?pos:int <span class="arrow">&#45;&gt;</span></span> <span>?last:<a href="TYPES/index.html#type-occurrence">TYPES.occurrence</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Re</span>.Str.regexp <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>search ~db ~f ?pos ?last regexp</code> searches a <code>regexp</code> in the database, starting either from <code>pos</code>, from after the last occurrence <code>last</code>, or from the beginning. Calls <code>f</code> for every occurrence found. <code>f</code> returns a boolean, that should be <code>true</code> if the search should continue after, or <code>false</code> if the search should terminate immediately.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-occurrence_line" class="anchored"><a href="#val-occurrence_line" class="anchor"></a><code><span><span class="keyword">val</span> occurrence_line : <span>db:<a href="TYPES/index.html#type-db">TYPES.db</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="TYPES/index.html#type-occurrence">TYPES.occurrence</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>occurrence_line ~db occ</code> returns the line number in the file.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-occurrence_context" class="anchored"><a href="#val-occurrence_context" class="anchor"></a><code><span><span class="keyword">val</span> occurrence_context : <span>db:<a href="TYPES/index.html#type-db">TYPES.db</a> <span class="arrow">&#45;&gt;</span></span> <span>line:int <span class="arrow">&#45;&gt;</span></span> <span><a href="TYPES/index.html#type-occurrence">TYPES.occurrence</a> <span class="arrow">&#45;&gt;</span></span> <span>max:int <span class="arrow">&#45;&gt;</span></span> <a href="TYPES/index.html#type-context">TYPES.context</a></span></code></div><div class="spec-doc"><p><code>occurrence_context ~db ~line occ ~max</code> returns the context of the occurrence of in the file. The <code>line</code> number of the occurrence, as provided by <code>occurrence_line</code> should be provided. The parameter <code>max</code> controls how many lines should be returned before and after the occurrence.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-time" class="anchored"><a href="#val-time" class="anchor"></a><code><span><span class="keyword">val</span> time : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>time msg f x</code> prints the time spent executing <code>f x</code>.</p></div></div></div></body></html>